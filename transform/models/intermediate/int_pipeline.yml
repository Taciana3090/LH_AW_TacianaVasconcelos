version: 2

models:
  - name: int_customer
    description: >
      Intermediate model containing consolidated customer information, 
      including personal details, address, and associated store data.
    columns:
      - name: customer_id
        description: >
          Unique identifier for the customer.
        tests:
          - not_null
          - unique
      - name: person_id
        description: >
          Identifier linking to the person entity. Nullable if the customer is a store.
        tests:
          - relationships:
              to: ref('stg_aw__person')
              field: business_entity_id
      - name: store_id
        description: >
          Identifier linking to the store entity. Defaults to 0 if not applicable.
        tests:
          - not_null
      - name: territory_id
        description: >
          Identifier linking to the sales territory of the customer.
        tests:
          - relationships:
              to: ref('stg_aw__salesterritory')
              field: territory_id
      - name: first_name
        description: >
          First name of the customer or contact person.
      - name: middle_name
        description: >
          Middle name of the customer or contact person, if available.
      - name: last_name
        description: >
          Last name of the customer or contact person.
      - name: name_title
        description: >
          Title of the customer or contact person (e.g., Mr., Ms., Dr.). Defaults to 'No Title'.
      - name: person_type
        description: >
          Classification of the person (e.g., Individual Customer, Store Contact).
      - name: name_suffix
        description: >
          Suffix of the customer's name (e.g., Jr., Sr.). Defaults to 'No Suffix'.
      - name: email_promotion
        description: >
          Flag indicating whether the customer is subscribed to email promotions.
      - name: email_address
        description: >
          Email address of the customer or contact person.
        tests:
          - unique
      - name: state_province_id
        description: >
          Identifier for the state or province associated with the customer's address.
        tests:
          - relationships:
              to: ref('stg_aw__stateprovince')
              field: state_province_id
      - name: state_province_name
        description: >
          Name of the state or province associated with the customer's address.
      - name: countryregion_code
        description: >
          Code of the country or region where the customer's address is located.
      - name: city_district_name
        description: >
          Name of the city or district where the customer's address is located.
      - name: store_name
        description: >
          Name of the store associated with the customer. Defaults to 'Not Informed' if unavailable.
      - name: full_name
        description: >
          Full name of the customer or contact person, including title, name, and suffix.


  - name: int_product
    description: > 
      Intermediate model consolidating product details with their respective subcategories 
      and categories for a comprehensive item catalog view.
    columns:
      - name: product_id
        description: > 
          Unique identifier for the product.
        tests:
          - not_null
          - unique
      - name: product_name
        description: > 
          Name of the product.
      - name: product_number
        description: > 
          Identification number assigned to the product.
      - name: color
        description: > 
          Color of the product, if available.
      - name: standard_cost
        description: > 
          The standard cost of the product.
      - name: listprice
        description: > 
          The retail price of the product.
      - name: name_product_subcategory
        description: > 
          Name of the subcategory to which the product belongs.
      - name: name_product_category
        description: > 
          Name of the category to which the product's subcategory belongs.


  - name: int_location
    description: >
      Intermediate view consolidating address, state/province, and country/region data.
      Provides detailed location-based information to support geographic performance analysis.
    columns:
      - name: address_line
        description: >
          Address line providing street and number details.
      - name: city
        description: >
          Name of the city where the address is located.
      - name: state_province_id
        description: >
          Unique identifier for the state or province associated with the address.
        tests:
          - not_null
          - relationships:
              to: ref('stg_aw__stateprovince')
              field: state_province_id
      - name: postal_code
        description: >
          Postal code for the address location.
      - name: state_province_code
        description: >
          Code representing the state or province.
      - name: countryregion_code
        description: >
          Code representing the country or region.
        tests:
          - not_null
          - relationships:
              to: ref('stg_aw__countryregion')
              field: countryregion_code
      - name: state_province_name
        description: >
          Full name of the state or province associated with the address.
      - name: sales_territory_id
        description: >
          Identifier for the sales territory linked to the state or province.
      - name: country_name
        description: >
          Full name of the country or region associated with the address.
  
  - name: salesorderdetail
    description: >
      Intermediate view that calculates gross revenue and discount for each sales order detail.
      It prepares data for further analysis by transforming raw sales order detail data.
    columns:
      - name: sales_order_id
        description: >
          Unique identifier for the sales order.
        tests:
          - not_null
          - unique
      - name: sales_order_detail_id
        description: >
          Unique identifier for the sales order detail.
        tests:
          - not_null
          - unique
      - name: order_quantity
        description: >
          Quantity of the product ordered in the sales order detail.
      - name: product_id
        description: >
          Unique identifier for the product included in the sales order detail.
        tests:
          - not_null
          - relationships:
              to: ref('stg_aw__product')
              field: product_id
      - name: unit_price
        description: >
          Price per unit of the product in the sales order detail.
      - name: unit_price_discount
        description: >
          Discount applied to the unit price of the product.
      - name: grossrevenue
        description: >
          Total gross revenue for the sales order detail, calculated as 
          order_quantity multiplied by unit_price.
      - name: discount
        description: >
          Total discount for the sales order detail, calculated as 
          order_quantity multiplied by unit_price multiplied by unit_price_discount.
  
  - name: salesreason
    description: >
      Intermediate view combining sales order reasons with their details, 
      including the reason name and type. This model provides a consolidated 
      view for analyzing sales order reasons.
    columns:
      - name: sales_order_id
        description: >
          Unique identifier for the sales order associated with the reason.
        tests:
          - not_null
          - relationships:
              to: ref('stg_aw__salesorderheadersalesreason')
              field: sales_order_id
      - name: sales_reason_id
        description: >
          Unique identifier for the sales reason.
        tests:
          - not_null
          - relationships:
              to: ref('stg_aw__salesreason')
              field: sales_reason_id
      - name: reason_name
        description: >
          Name of the sales reason, providing context for the reason associated with the sales order.
      - name: reason_type
        description: >
          Type or category of the sales reason, offering additional classification for analysis.